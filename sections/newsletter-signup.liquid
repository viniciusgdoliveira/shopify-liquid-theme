{% comment %}
  Enhanced newsletter signup section with advanced features:
  - Newsletter subscription form
  - Email validation
  - Success/error messaging
  - Performance optimizations
  - Accessibility compliance
{% endcomment %}

{% liquid
  assign show_newsletter_title = section.settings.show_newsletter_title
  assign show_newsletter_subtitle = section.settings.show_newsletter_subtitle
  assign newsletter_title = section.settings.newsletter_title | default: 'newsletter.general.title'
  assign newsletter_subtitle = section.settings.newsletter_subtitle | default: 'newsletter.general.subtitle'
  assign newsletter_placeholder = section.settings.newsletter_placeholder | default: 'newsletter.general.email_placeholder'
  assign newsletter_button_text = section.settings.newsletter_button_text | default: 'newsletter.general.subscribe'
  assign enable_newsletter_validation = section.settings.enable_newsletter_validation
  assign enable_newsletter_analytics = section.settings.enable_newsletter_analytics
  assign newsletter_background_color = section.settings.newsletter_background_color
  assign newsletter_text_color = section.settings.newsletter_text_color
  assign newsletter_button_color = section.settings.newsletter_button_color
  assign newsletter_button_text_color = section.settings.newsletter_button_text_color
%}

<div class="newsletter-section" id="shopify-section-{{ section.id }}" style="background-color: {{ newsletter_background_color }}; color: {{ newsletter_text_color }};">
  <div class="newsletter-section__container">
    <div class="newsletter-section__content">
      {% comment %} Newsletter Header {% endcomment %}
      {% if show_newsletter_title %}
        <div class="newsletter-section__header">
          <h2 class="newsletter-section__title">{{ newsletter_title | t }}</h2>
          {% if show_newsletter_subtitle %}
            <p class="newsletter-section__subtitle">{{ newsletter_subtitle | t }}</p>
          {% endif %}
        </div>
      {% endif %}

      {% comment %} Newsletter Form {% endcomment %}
      <div class="newsletter-section__form">
        {% form 'customer', class: 'newsletter-form', data-newsletter-form: 'newsletter' %}
          <div class="newsletter-form__field">
            <input
              type="email"
              name="contact[email]"
              class="newsletter-form__input"
              placeholder="{{ newsletter_placeholder | t }}"
              required
              autocomplete="email"
              aria-label="{{ 'newsletter.general.email_label' | t }}"
            >
            <button type="submit" class="newsletter-form__submit" style="background-color: {{ newsletter_button_color }}; color: {{ newsletter_button_text_color }};">
              {{ newsletter_button_text | t }}
            </button>
          </div>
          
          <div class="newsletter-form__success" style="display: none;">
            {{ 'newsletter.general.success' | t }}
          </div>
          
          <div class="newsletter-form__error" style="display: none;">
            {{ 'newsletter.general.error' | t }}
          </div>
        {% endform %}
      </div>

      {% comment %} Newsletter Benefits {% endcomment %}
      {% if section.settings.show_newsletter_benefits %}
        <div class="newsletter-section__benefits">
          <ul class="newsletter-section__benefits-list">
            {% if section.settings.newsletter_benefit_1 != blank %}
              <li class="newsletter-section__benefit">
                {% render 'icons', icon: 'check' %}
                <span>{{ section.settings.newsletter_benefit_1 }}</span>
              </li>
            {% endif %}
            
            {% if section.settings.newsletter_benefit_2 != blank %}
              <li class="newsletter-section__benefit">
                {% render 'icons', icon: 'check' %}
                <span>{{ section.settings.newsletter_benefit_2 }}</span>
              </li>
            {% endif %}
            
            {% if section.settings.newsletter_benefit_3 != blank %}
              <li class="newsletter-section__benefit">
                {% render 'icons', icon: 'check' %}
                <span>{{ section.settings.newsletter_benefit_3 }}</span>
              </li>
            {% endif %}
          </ul>
        </div>
      {% endif %}

      {% comment %} Newsletter Privacy Notice {% endcomment %}
      {% if section.settings.show_privacy_notice %}
        <div class="newsletter-section__privacy">
          <p class="newsletter-section__privacy-text">
            {{ 'newsletter.general.privacy_notice' | t }}
          </p>
        </div>
      {% endif %}
    </div>
  </div>
</div>

{% stylesheet %}
.newsletter-section {
  padding: var(--space-8) 0;
  background: var(--color-background-secondary);
}

.newsletter-section__container {
  max-width: var(--container-lg);
  margin: 0 auto;
  padding: 0 var(--space-4);
}

.newsletter-section__content {
  text-align: center;
}

.newsletter-section__header {
  margin-bottom: var(--space-6);
}

.newsletter-section__title {
  font-size: clamp(var(--font-size-2xl), 4vw, var(--font-size-4xl));
  font-weight: var(--font-weight-bold);
  color: var(--color-text-primary);
  margin: 0 0 var(--space-3) 0;
  letter-spacing: var(--letter-spacing-tight);
}

.newsletter-section__subtitle {
  font-size: var(--font-size-lg);
  color: var(--color-text-secondary);
  max-width: 600px;
  margin: 0 auto;
  line-height: var(--line-height-relaxed);
}

.newsletter-section__form {
  margin-bottom: var(--space-6);
}

.newsletter-form {
  max-width: 500px;
  margin: 0 auto;
}

.newsletter-form__field {
  display: flex;
  gap: var(--space-3);
  margin-bottom: var(--space-4);
}

.newsletter-form__input {
  flex: 1;
  padding: var(--space-3) var(--space-4);
  border: var(--border-width-1) solid var(--color-border);
  border-radius: var(--radius-base);
  background: var(--color-background);
  color: var(--color-text-primary);
  font-size: var(--font-size-base);
  transition: all var(--duration-200) var(--ease-out);
}

.newsletter-form__input:focus {
  outline: none;
  border-color: var(--color-primary);
  box-shadow: 0 0 0 3px rgba(var(--color-primary-rgb), 0.1);
}

.newsletter-form__input:invalid {
  border-color: var(--color-error);
}

.newsletter-form__submit {
  padding: var(--space-3) var(--space-6);
  border: var(--border-width-1) solid var(--color-primary);
  border-radius: var(--radius-base);
  background: var(--color-primary);
  color: var(--color-text-inverse);
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-semibold);
  cursor: pointer;
  transition: all var(--duration-200) var(--ease-out);
  white-space: nowrap;
}

.newsletter-form__submit:hover {
  background: var(--color-primary-hover);
  border-color: var(--color-primary-hover);
}

.newsletter-form__submit:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.newsletter-form__success,
.newsletter-form__error {
  padding: var(--space-3) var(--space-4);
  border-radius: var(--radius-base);
  margin-bottom: var(--space-4);
  display: none;
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
}

.newsletter-form__success {
  background: var(--color-success);
  color: var(--color-text-inverse);
}

.newsletter-form__error {
  background: var(--color-error);
  color: var(--color-text-inverse);
}

.newsletter-form__success.show,
.newsletter-form__error.show {
  display: block;
}

.newsletter-section__benefits {
  margin-bottom: var(--space-6);
}

.newsletter-section__benefits-list {
  list-style: none;
  padding: 0;
  margin: 0;
  display: flex;
  justify-content: center;
  gap: var(--space-6);
  flex-wrap: wrap;
}

.newsletter-section__benefit {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
}

.newsletter-section__benefit svg {
  width: 16px;
  height: 16px;
  color: var(--color-success);
  flex-shrink: 0;
}

.newsletter-section__privacy {
  margin-top: var(--space-4);
}

.newsletter-section__privacy-text {
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
  margin: 0;
  line-height: var(--line-height-relaxed);
}

/* Responsive Design */
@media screen and (max-width: 768px) {
  .newsletter-section {
    padding: var(--space-6) 0;
  }
  
  .newsletter-section__container {
    padding: 0 var(--space-3);
  }
  
  .newsletter-form__field {
    flex-direction: column;
  }
  
  .newsletter-form__submit {
    width: 100%;
  }
  
  .newsletter-section__benefits-list {
    flex-direction: column;
    gap: var(--space-3);
  }
}

@media screen and (max-width: 480px) {
  .newsletter-section__title {
    font-size: var(--font-size-xl);
  }
  
  .newsletter-section__subtitle {
    font-size: var(--font-size-base);
  }
}
{% endstylesheet %}

{% schema %}
{
  "name": "Newsletter Signup",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Newsletter Content"
    },
    {
      "type": "checkbox",
      "id": "show_newsletter_title",
      "default": true,
      "label": "Show newsletter title"
    },
    {
      "type": "text",
      "id": "newsletter_title",
      "label": "Newsletter title",
      "default": "newsletter.general.title"
    },
    {
      "type": "checkbox",
      "id": "show_newsletter_subtitle",
      "default": true,
      "label": "Show newsletter subtitle"
    },
    {
      "type": "text",
      "id": "newsletter_subtitle",
      "label": "Newsletter subtitle",
      "default": "newsletter.general.subtitle"
    },
    {
      "type": "text",
      "id": "newsletter_placeholder",
      "label": "Email placeholder",
      "default": "newsletter.general.email_placeholder"
    },
    {
      "type": "text",
      "id": "newsletter_button_text",
      "label": "Button text",
      "default": "newsletter.general.subscribe"
    },
    {
      "type": "header",
      "content": "Newsletter Benefits"
    },
    {
      "type": "checkbox",
      "id": "show_newsletter_benefits",
      "default": true,
      "label": "Show newsletter benefits"
    },
    {
      "type": "text",
      "id": "newsletter_benefit_1",
      "label": "Benefit 1",
      "default": "Exclusive offers and discounts"
    },
    {
      "type": "text",
      "id": "newsletter_benefit_2",
      "label": "Benefit 2",
      "default": "Early access to new products"
    },
    {
      "type": "text",
      "id": "newsletter_benefit_3",
      "label": "Benefit 3",
      "default": "Sustainability tips and updates"
    },
    {
      "type": "header",
      "content": "Privacy & Legal"
    },
    {
      "type": "checkbox",
      "id": "show_privacy_notice",
      "default": true,
      "label": "Show privacy notice"
    },
    {
      "type": "header",
      "content": "Newsletter Features"
    },
    {
      "type": "checkbox",
      "id": "enable_newsletter_validation",
      "default": true,
      "label": "Enable email validation"
    },
    {
      "type": "checkbox",
      "id": "enable_newsletter_analytics",
      "default": true,
      "label": "Enable analytics tracking"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "newsletter_background_color",
      "label": "Background color",
      "default": "#f8f9fa"
    },
    {
      "type": "color",
      "id": "newsletter_text_color",
      "label": "Text color",
      "default": "#333333"
    },
    {
      "type": "color",
      "id": "newsletter_button_color",
      "label": "Button color",
      "default": "#007bff"
    },
    {
      "type": "color",
      "id": "newsletter_button_text_color",
      "label": "Button text color",
      "default": "#ffffff"
    }
  ],
  "presets": [
    {
      "name": "Newsletter Signup"
    }
  ]
}
{% endschema %}
