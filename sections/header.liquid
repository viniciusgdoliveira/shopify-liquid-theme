<shopify-header class="header full-width" id="shopify-section-header" role="banner">
  <div class="header__wrapper page-width">
    <!-- Mobile Menu Toggle -->
    <button class="header__mobile-toggle" aria-label="{{ 'general.accessibility.menu' | t }}" aria-expanded="false" aria-controls="mobile-menu" data-mobile-menu-trigger>
      <span class="header__hamburger" aria-hidden="true">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </button>

    <!-- Logo -->
    <div class="header__logo">
      {% if section.settings.logo %}
        <a href="{{ routes.root_url }}" class="header__logo-link" aria-label="{{ shop.name | escape }}">
          {% render 'image', 
            image: section.settings.logo, 
            class: 'header__logo-image',
            width: 150,
            alt: shop.name
          %}
        </a>
      {% else %}
        <h1 class="header__logo-text">
          <a href="{{ routes.root_url }}" aria-label="{{ shop.name | escape }}">{{ shop.name }}</a>
        </h1>
      {% endif %}
    </div>

    <!-- Main Navigation -->
    <nav class="header__nav" role="navigation" aria-label="{{ 'general.accessibility.main_navigation' | t }}" id="main-navigation">
      {% if section.settings.menu %}
        <ul class="header__menu" role="menubar">
          {% for link in section.settings.menu.links %}
            <li class="header__menu-item{% if link.active %} header__menu-item--active{% endif %}" role="none">
              <a href="{{ link.url }}" class="header__menu-link" role="menuitem"{% if link.active %} aria-current="page"{% endif %}>
                {{ link.title }}
              </a>
              {% if link.links.size > 0 %}
                <ul class="header__submenu" role="menu" aria-label="{{ link.title | escape }} submenu">
                  {% for childlink in link.links %}
                    <li class="header__submenu-item" role="none">
                      <a href="{{ childlink.url }}" class="header__submenu-link" role="menuitem">
                        {{ childlink.title }}
                      </a>
                    </li>
                  {% endfor %}
                </ul>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <!-- Fallback menu when no menu is assigned -->
        <ul class="header__menu" role="menubar">
          <li class="header__menu-item" role="none">
            <a href="{{ routes.root_url }}" class="header__menu-link" role="menuitem">{{ 'general.navigation.home' | t }}</a>
          </li>
          <li class="header__menu-item" role="none">
            <a href="{{ routes.collections_url }}" class="header__menu-link" role="menuitem">{{ 'general.navigation.collections' | t }}</a>
          </li>
          <li class="header__menu-item" role="none">
            <a href="{{ routes.all_products_collection_url }}" class="header__menu-link" role="menuitem">{{ 'general.navigation.products' | t }}</a>
          </li>
        </ul>
      {% endif %}
    </nav>

    <!-- Header Actions -->
    <div class="header__actions" role="toolbar" aria-label="{{ 'general.accessibility.header_actions' | t }}">
      <!-- Search -->
      {% if section.settings.enable_search and settings.enable_predictive_search %}
        <div class="header__search">
          <button class="header__search-toggle" aria-label="{{ 'general.search.search' | t }}" aria-expanded="false" aria-controls="search-form" data-search-trigger>
            {% render 'icons', icon: 'search' %}
          </button>
          <div class="header__search-form" id="search-form" role="search" aria-label="{{ 'general.search.search' | t }}">
            {% render 'search-form' %}
          </div>
        </div>
      {% endif %}

      <!-- Account -->
      {% if shop.customer_accounts_enabled %}
        <div class="header__account">
          <a href="{{ routes.account_url }}" class="header__account-link" aria-label="{{ 'general.accessibility.account' | t }}">
            {% render 'icons', icon: 'user' %}
            <span class="header__account-text">{{ 'general.accessibility.account' | t }}</span>
          </a>
        </div>
      {% endif %}

      <!-- Cart -->
      <div class="header__cart">
        {%- if settings.cart_behavior == 'drawer' -%}
          <button class="header__cart-link" data-cart-drawer-trigger aria-label="{{ 'general.accessibility.cart' | t }}" aria-expanded="false" aria-controls="cart-drawer">
            {% render 'icons', icon: 'cart' %}
            <span class="header__cart-count cart-count" data-cart-count aria-label="{{ 'cart.item_count' | t: count: cart.item_count }}">
              {{ cart.item_count }}
            </span>
          </button>
        {%- else -%}
          <a href="{{ routes.cart_url }}" class="header__cart-link" aria-label="{{ 'general.accessibility.cart' | t }}">
            {% render 'icons', icon: 'cart' %}
            <span class="header__cart-count cart-count" data-cart-count aria-label="{{ 'cart.item_count' | t: count: cart.item_count }}">
              {{ cart.item_count }}
            </span>
          </a>
        {%- endif -%}
      </div>
    </div>
  </div>

  <!-- Mobile Menu Overlay -->
  <div class="header__mobile-menu" id="mobile-menu" role="dialog" aria-modal="true" aria-label="{{ 'general.accessibility.mobile_menu' | t }}" aria-hidden="true">
    <div class="header__mobile-menu-content">
      {% if section.settings.menu %}
        <ul class="header__mobile-menu-list" role="menubar">
          {% for link in section.settings.menu.links %}
            <li class="header__mobile-menu-item" role="none">
              <a href="{{ link.url }}" class="header__mobile-menu-link" role="menuitem"{% if link.active %} aria-current="page"{% endif %}>
                {{ link.title }}
              </a>
              {% if link.links.size > 0 %}
                <ul class="header__mobile-submenu" role="menu" aria-label="{{ link.title | escape }} submenu">
                  {% for childlink in link.links %}
                    <li class="header__mobile-submenu-item" role="none">
                      <a href="{{ childlink.url }}" class="header__mobile-submenu-link" role="menuitem">
                        {{ childlink.title }}
                      </a>
                    </li>
                  {% endfor %}
                </ul>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <!-- Fallback mobile menu -->
        <ul class="header__mobile-menu-list" role="menubar">
          <li class="header__mobile-menu-item" role="none">
            <a href="{{ routes.root_url }}" class="header__mobile-menu-link" role="menuitem">{{ 'general.navigation.home' | t }}</a>
          </li>
          <li class="header__mobile-menu-item" role="none">
            <a href="{{ routes.collections_url }}" class="header__mobile-menu-link" role="menuitem">{{ 'general.navigation.collections' | t }}</a>
          </li>
          <li class="header__mobile-menu-item" role="none">
            <a href="{{ routes.all_products_collection_url }}" class="header__mobile-menu-link" role="menuitem">{{ 'general.navigation.products' | t }}</a>
          </li>
        </ul>
      {% endif %}
    </div>
  </div>
</shopify-header>

{% comment %}
  Header section styles are now loaded from assets/header.css
  Header section scripts are now loaded from assets/header.js
{% endcomment %}

{% schema %}
{
  "name": "t:general.header",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "t:general.header.logo"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "t:labels.menu"
    },
    {
      "type": "checkbox",
      "id": "enable_search",
      "label": "t:general.header.enable_search",
      "default": true
    }
  ]
}
{% endschema %}
